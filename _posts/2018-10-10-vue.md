---
layout: post
title:  "vue 优化"
tags:
categories:
---

### 监听input框 获取搜索列表
```vue
watch: {
    searchInputValue:{
        handler: 'getList', //getList 获取列表方法
        immediate: true
    }
}
```

### 路由切换 同一组件 页面不刷新问题
`方法1`
```vue
'$route': {
    handler: 'resetData', 
    immediate: true
}
```
`方法2`损失了一丢丢性能，但避免了无限的bug
```vue
<router-view :key="$route.fullpath"></router-view>
```

### beforeRouteEnter 中调用this
```vue
beforeRouteEnter(to, from, next){
      next(vm => {
        //vm ==this 
      })
},
```

### 一劳永逸的组件注册
借助一下神器`webpack`，使用 `require.context()` 方法来创建自己的（模块）上下文，从而实现自动动态require组件。

components文件夹添加一个叫`global.js`的文件，在这个文件里借助webpack动态将需要的基础组件统统打包进来。

在`main.js`中import 'components/global.js'
```javascript
import Vue from 'vue'
 
function capitalizeFirstLetter(string) {
  return string.charAt(0).toUpperCase() + string.slice(1)
}
 
const requireComponent = require.context(
  '.', false, /\.vue$/
   //找到components文件夹下以.vue命名的文件
)
 
requireComponent.keys().forEach(fileName => {
  const componentConfig = requireComponent(fileName)
 
  const componentName = capitalizeFirstLetter(
    fileName.replace(/^\.\//, '').replace(/\.\w+$/, '')
    //因为得到的filename格式是: './baseButton.vue', 所以这里我们去掉头和尾，只保留真正的文件名
  )
 
  Vue.component(componentName, componentConfig.default || componentConfig)
})
```

